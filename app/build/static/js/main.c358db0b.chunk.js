(this["webpackJsonpmidu-bootcamp"]=this["webpackJsonpmidu-bootcamp"]||[]).push([[0],{26:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var r=n(19),a=n.n(r),c=n(4),o=n.n(c),s=n(7),i=n(20),u=n(3),l=(n(26),n(1)),j=n(0),d=function(e){var t=e.note;return Object(j.jsx)("li",{children:Object(j.jsx)("p",{children:t.content})})},b=n(5),h=n.n(b),O="/api/notes/",p=null,f=function(){return h.a.get(O).then((function(e){return e.data}))},g=function(e){var t={headers:{Authorization:p}};return h.a.post(O,e,t).then((function(e){return e.data}))},v=function(e){p="Bearer ".concat(e)},x=function(){var e=Object(s.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login/",t);case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m={login:x},w=Object(l.forwardRef)((function(e,t){var n=e.children,r=e.buttonLabel,a=void 0===r?"toggleVisibility":r,c=Object(l.useState)(!1),o=Object(u.a)(c,2),s=o[0],i=o[1],d={display:s?"none":""},b={display:s?"":"none"},h=function(){return i(!s)};return Object(l.useImperativeHandle)(t,(function(){return{toggleVisibility:h}})),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{style:d,children:Object(j.jsx)("button",{onClick:h,children:a})}),Object(j.jsxs)("div",{style:b,children:[n,Object(j.jsx)("button",{onClick:h,children:"Cancel"})]})]})}));w.displayName="Togglable";var S=w;function y(e){var t=e.username,n=e.password,r=e.handleLogin,a=e.handlePasswordChange,c=e.handleUsernameChange;return Object(j.jsx)(S,{buttonLabel:"Show login",children:Object(j.jsxs)("form",{onSubmit:r,children:[Object(j.jsx)("div",{children:Object(j.jsx)("input",{type:"text",value:t,name:"Username",placeholder:"Username",onChange:c})}),Object(j.jsx)("div",{children:Object(j.jsx)("input",{type:"password",value:n,name:"Password",placeholder:"Password",onChange:a})}),Object(j.jsx)("button",{children:"Login"})]})})}function C(e){var t=e.handleLogOut,n=e.addNote,r=Object(l.useState)(""),a=Object(u.a)(r,2),c=a[0],o=a[1],s=Object(l.useRef)();return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)(S,{ref:s,buttonLabel:"Add new note",children:[Object(j.jsx)("div",{children:Object(j.jsx)("button",{onClick:t,children:"Cerrar Sesi\xf3n"})}),Object(j.jsx)("div",{children:Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={content:c,important:Math.random()>.5};n(t),o(""),s.current.toggleVisibility()},children:[Object(j.jsx)("input",{value:c,onChange:function(e){var t=e.target;o(t.value)}}),Object(j.jsx)("button",{children:"Save"})]})})]})})}function k(e){var t=e.errorMessage;return Object(j.jsx)("h2",{style:{display:"inline",backgroundColor:"red",color:"#ccc"},children:t})}function N(){var e=Object(l.useState)([]),t=Object(u.a)(e,2),n=t[0],r=t[1],a=Object(l.useState)(null),c=Object(u.a)(a,2),b=c[0],h=c[1],O=Object(l.useState)(!0),p=Object(u.a)(O,2),x=p[0],w=p[1],S=Object(l.useState)(""),N=Object(u.a)(S,2),L=N[0],U=N[1],A=Object(l.useState)(""),I=Object(u.a)(A,2),J=I[0],P=I[1],M=Object(l.useState)(null),V=Object(u.a)(M,2),B=V[0],D=V[1];Object(l.useEffect)((function(){var e=window.localStorage.getItem("loggedNoteAppUser");if(e){var t=JSON.parse(e);D(t),v(t.token)}}),[]);var E=function(){var e=Object(s.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,m.login({username:L,password:J});case 4:n=e.sent,window.localStorage.setItem("loggedNoteAppUser",JSON.stringify(n)),console.log("Hola"),f().then((function(e){r(e)})),console.log(n),v(n.token),D(n),U(""),P(""),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),h("Wrong username or password"),setTimeout((function(){h(null)}),3e3);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),F=n;return Object(j.jsxs)("div",{children:[Object(j.jsx)("h1",{children:"Notes"}),b?Object(j.jsx)(k,{errorMessage:b}):"",B?Object(j.jsx)(C,{handleLogOut:function(){D(null),v(B.token),window.localStorage.removeItem("loggedNoteAppUser"),r([])},addNote:function(e){g(e).then((function(e){r([].concat(Object(i.a)(n),[e]))}))}}):Object(j.jsx)(y,{username:L,password:J,handleUsernameChange:function(e){return U(e.target.value)},handlePasswordChange:function(e){return P(e.target.value)},handleLogin:E}),Object(j.jsx)("div",{children:Object(j.jsxs)("button",{onClick:function(){return w(!x)},children:["show"," ",x?"important":"all"]})}),Object(j.jsx)("ul",{children:F.map((function(e,t){return Object(j.jsx)(d,{note:e},t)}))})]})}var L=document.getElementById("root");a.a.render(Object(j.jsx)(N,{}),L)}},[[47,1,2]]]);
//# sourceMappingURL=main.c358db0b.chunk.js.map